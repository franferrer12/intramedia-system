# Roadmap de Implementaci√≥n - SIN Integraciones Externas

## Visi√≥n General

**Duraci√≥n total:** 12 semanas (en lugar de 16)
**MVP funcional:** 6 semanas
**Sistema completo:** 12 semanas

**SIMPLIFICADO:** Sin dependencias de Fourvenues, POS u otros sistemas externos.
Todo es aut√≥nomo y bajo tu control total.

---

## FASE 0: Setup Inicial (Semana 1)

### Objetivos
- ‚úÖ Repositorio GitHub configurado
- ‚úÖ Estructura base de proyecto
- ‚úÖ Docker configurado
- ‚úÖ CI/CD b√°sico
- ‚úÖ Base de datos inicial

### Tareas

#### D√≠a 1-2: Repositorio y Estructura
**Con Claude Code:**
```
"Crea la estructura completa del proyecto Club Management:
- Backend: Spring Boot 3.2+ con Maven
- Frontend: React 18 + TypeScript con Vite
- Configuraci√≥n Docker Compose
- GitHub Actions para CI/CD
- Documentaci√≥n inicial

Incluye:
- pom.xml con todas las dependencias
- package.json con todas las dependencias
- docker-compose.yml con postgres, backend, frontend
- .github/workflows/ para CI
- README.md b√°sico"
```

**Entregables:**
- `club-management/` con estructura completa
- Dependencies instaladas
- Docker Compose funcional

#### D√≠a 3-4: Base de Datos
```
"Crea las migraciones Flyway iniciales:

V001__create_base_tables.sql:
- Tablas: categorias_producto, proveedores

V002__create_usuarios.sql:
- Tabla usuarios con roles
- Usuario admin por defecto (password hasheado)

Genera tambi√©n el c√≥digo para:
- Entity Usuario
- UserDetailsService para Spring Security
- JWT configuration b√°sica"
```

**Entregables:**
- Migraciones Flyway
- Sistema de autenticaci√≥n funcional

#### D√≠a 5: Testing y Documentaci√≥n
```
"Configura el ambiente de testing:
- TestContainers para PostgreSQL
- Test base classes
- Configuraci√≥n de cobertura (JaCoCo)
- Test ejemplo que pase

Frontend:
- Vitest configurado
- React Testing Library
- Test ejemplo"
```

**Entregables:**
- Tests passing
- Coverage reports configurados

---

## FASE 1: MVP Core (Semanas 2-6)

### Sprint 1: Autenticaci√≥n + Eventos (Semanas 2-3)

#### Semana 2: Backend

**Lunes-Martes: Autenticaci√≥n**
```
"Implementa sistema completo de autenticaci√≥n:

Backend:
- LoginRequest, LoginResponse DTOs
- AuthenticationService con JWT
- AuthenticationController (/api/auth/login, /api/auth/refresh, /api/auth/me)
- Security configuration completa
- Tests de autenticaci√≥n"
```

**Mi√©rcoles-Viernes: Eventos**
```
"Implementa m√≥dulo completo de EVENTOS:

Entidad Evento:
- id, nombre, fecha, horaInicio, horaFin
- tipo (enum), estado (enum)
- aforoEsperado, aforoReal
- artista, cacheArtista
- ingresosEstimados, gastosEstimados
- ingresosReales, gastosReales

CRUD completo:
- EventoService con todos los m√©todos
- EventoController con endpoints REST
- DTOs (CreateEventoRequest, UpdateEventoRequest, EventoDTO)
- Migraci√≥n V003__create_eventos.sql
- Tests unitarios e integraci√≥n"
```

**Entregables:**
- ‚úÖ Login funcional con JWT
- ‚úÖ CRUD eventos completo
- ‚úÖ Tests passing (>80% coverage)

#### Semana 3: Frontend

**Lunes-Martes: Autenticaci√≥n**
```
"Implementa autenticaci√≥n en frontend:

Componentes:
- LoginPage con formulario
- Validaci√≥n con Zod
- authService.ts (login, refresh, getCurrentUser)
- authStore con Zustand (user, token, login, logout)
- ProtectedRoute component
- Axios interceptor para JWT

Layout:
- Layout principal con navbar
- Sidebar con navegaci√≥n
- User menu con logout"
```

**Mi√©rcoles-Viernes: Eventos**
```
"Implementa gesti√≥n de eventos en frontend:

P√°ginas y componentes:
- EventosPage con lista y filtros
- EventoTable con TanStack Table
- EventoForm (crear/editar) en modal
- Calendario con react-big-calendar
- eventoService.ts con CRUD
- Types de evento

Features:
- Lista paginada con filtros (fecha, tipo, estado)
- Formulario validado
- Vista calendario mensual
- Acciones: ver, editar, eliminar"
```

**Entregables:**
- ‚úÖ Login page funcional
- ‚úÖ Layout principal
- ‚úÖ Gesti√≥n eventos completa
- ‚úÖ Calendario visual

---

### Sprint 2: Gesti√≥n Financiera (Semanas 4-5)

#### Semana 4: Backend Finanzas

**Lunes-Martes: Proveedores y Gastos**
```
"Implementa m√≥dulos de Proveedores y Gastos:

1. PROVEEDOR:
   - Entity, Repository, Service, Controller
   - CRUD b√°sico
   - Migraci√≥n V004__create_proveedores.sql

2. GASTO:
   - Entity con relaci√≥n a Evento y Proveedor
   - Repository con queries custom:
     * findByEventoId
     * sumMontoByEvento
     * findByCategoriaAndFechaBetween
   - Service con l√≥gica:
     * crearGasto (actualiza gastos del evento)
     * calcularGastosPorCategoria
     * marcarComoPagado
   - Controller con endpoints completos
   - Migraci√≥n V005__create_gastos.sql
   - Tests completos"
```

**Mi√©rcoles-Jueves: Ingresos**
```
"Implementa m√≥dulo de INGRESOS:

Entity Ingreso:
- Campos: fuente, monto, metodoPago, fecha
- cantidad_entradas, precio_unitario (para taquilla)
- notas (para registro manual)

Fuentes de ingreso:
- TAQUILLA_ANTICIPADA (registrada manualmente)
- TAQUILLA_FISICA (registrada manualmente)
- BARRA (registrada manualmente del POS)
- GUARDARROPA
- OTROS

Service:
- registrarIngreso (actualiza ingresos del evento)
- obtenerIngresosPorFuente
- importarDesdeCSV (para importaci√≥n manual)

Controller con endpoints
Migraci√≥n V006__create_ingresos.sql
Tests"
```

**Viernes: P&L Service**
```
"Implementa servicio de an√°lisis financiero:

FinanzasService:
- calcularPyL(Long eventoId) ‚Üí ProfitLossDTO
  * Total ingresos por fuente
  * Total gastos por categor√≠a
  * Beneficio neto
  * Margen %
  
- obtenerResumenMensual(mes, a√±o) ‚Üí ResumenMensualDTO
  * Eventos del mes
  * Ingresos/gastos totales
  * Promedio por evento
  
- compararEventos(Long eventoId1, Long eventoId2)

Controller: FinanzasController
Tests"
```

**Entregables:**
- ‚úÖ CRUD proveedores, gastos, ingresos
- ‚úÖ C√°lculo P&L autom√°tico
- ‚úÖ Tests passing

#### Semana 5: Frontend Finanzas

**Lunes: Proveedores**
```
"P√°gina de Proveedores:
- ProveedoresPage con tabla
- Formulario crear/editar
- Filtros por categor√≠a
- proveedorService.ts"
```

**Martes-Mi√©rcoles: Gastos**
```
"P√°gina completa de Gastos:
- GastosPage con tabla avanzada
- Columnas: concepto, categor√≠a, monto, proveedor, fecha, pagado
- Filtros: evento, categor√≠a, rango fechas, pagado/pendiente
- GastoForm con selects de evento y proveedor
- Acci√≥n: marcar como pagado
- gastoService.ts
- Badge de estado (pagado/pendiente)"
```

**Jueves: Ingresos**
```
"P√°gina de Ingresos:

IMPORTANTE: Sin integraci√≥n autom√°tica.

Features:
- IngresosPage con tabla
- Columnas: fuente, monto, m√©todo pago, fecha, notas
- Filtros por evento y fuente
- Formulario REGISTRO MANUAL con:
  * Selecci√≥n de evento
  * Selecci√≥n de fuente (Taquilla Anticipada, Barra, etc.)
  * Monto total
  * M√©todo de pago
  * Notas (ej: 'Total del reporte Fourvenues')
- ingresoService.ts

A√±ade tambi√©n:
- Bot√≥n 'Importar CSV' para importaci√≥n masiva opcional
- Vista previa antes de importar"
```

**Viernes: Vista Financiera de Evento**
```
"Vista detallada financiera:
- EventoFinanzasView component
- Secciones:
  * Resumen (ingresos, gastos, beneficio)
  * Gr√°fico pie: distribuci√≥n gastos
  * Gr√°fico bar: ingresos por fuente
  * Tabla de gastos del evento
  * Tabla de ingresos del evento
- Comparativa: estimado vs real
- Bot√≥n 'Registrar Ingreso R√°pido' 
  (para a√±adir ingresos post-evento)"
```

**Entregables:**
- ‚úÖ Gesti√≥n completa de gastos e ingresos MANUAL
- ‚úÖ Vista P&L por evento
- ‚úÖ Dashboard financiero b√°sico
- ‚úÖ Importador CSV opcional

---

### Sprint 3: Personal B√°sico (Semana 6)

#### Lunes-Mi√©rcoles: Backend
```
"Implementa m√≥dulos de Empleados y Turnos:

EMPLEADO:
- Entity con campos completos
- Repository con queries:
  * findByActivo
  * findByRolPrincipal
- Service con CRUD
- Controller
- Migraci√≥n V007__create_empleados.sql

TURNO:
- Entity con relaci√≥n a Evento y Empleado
- Repository:
  * findByEventoId
  * findByEmpleadoIdAndFechaBetween
- Service:
  * asignarTurno
  * registrarHoras
  * calcularMontosAutomaticamente
- Controller
- Migraci√≥n V008__create_turnos.sql

Tests completos"
```

#### Jueves-Viernes: Frontend
```
"Frontend de Personal:

EmpleadosPage:
- Tabla con empleados activos
- Formulario completo (datos personales, contrato, salario)
- Filtros por rol y estado
- empleadoService.ts

Asignaci√≥n de Turnos:
- En EventoDetailPage, secci√≥n de personal
- TurnoForm: seleccionar empleado, rol, horario
- Lista de turnos asignados
- turnoService.ts

CalendarioEmpleadoView (opcional):
- Vista de turnos de un empleado
- Calendario semanal/mensual"
```

**Entregables FASE 1:**
- ‚úÖ Sistema de autenticaci√≥n completo
- ‚úÖ Gesti√≥n de eventos
- ‚úÖ Gesti√≥n financiera MANUAL (gastos/ingresos/P&L)
- ‚úÖ Gesti√≥n b√°sica de personal
- ‚úÖ **Sistema MVP deployable y usable**

---

## FASE 2: Funcionalidades Avanzadas (Semanas 7-11)

### Sprint 4: N√≥minas (Semanas 7-8)

#### Semana 7: Backend N√≥minas

```
"Implementa sistema completo de n√≥minas:

Entity Nomina:
- Campos: empleadoId, mes, a√±o
- Devengos: salarioBase, horasExtra, comisiones, bonos
- Deducciones: irpf, seguridadSocial, anticipos
- totalNeto
- estado, fechaPago, rutaPDF

NominaService:
- calcularNominaMes(empleadoId, mes, a√±o):
  * Obtener todos los turnos del empleado en el mes
  * Sumar horas trabajadas y extra
  * Calcular devengos
  * Calcular deducciones (IRPF seg√∫n tramos, SS seg√∫n tipo contrato)
  * Generar Nomina entity
  
- generarTodasNominasMes(mes, a√±o):
  * Calcular para todos los empleados activos
  
- generarPDF(nominaId):
  * JasperReports con plantilla profesional
  * Guardar en filesystem
  
- marcarComoPagada(nominaId, fechaPago)

NominaController
Migraci√≥n V009__create_nominas.sql
Tests"
```

**Plantilla JasperReports:**
```
"Crea plantilla JasperReports para n√≥mina:

Secciones:
- Header: Logo, datos empresa
- Datos empleado
- Per√≠odo (mes/a√±o)
- Devengos (tabla)
- Deducciones (tabla)
- Total l√≠quido (destacado)
- Firma

Formato: A4, profesional"
```

#### Semana 8: Frontend N√≥minas

```
"Frontend de N√≥minas:

NominasPage:
- Filtros: mes, a√±o, empleado, estado
- Tabla con resumen
- nominaService.ts

GenerarNominasWizard:
- Step 1: Seleccionar mes/a√±o
- Step 2: Preview de empleados y montos calculados
- Step 3: Confirmar generaci√≥n
- Step 4: Ver resultados

NominaDetailView:
- Desglose completo
- Bot√≥n descargar PDF
- Bot√≥n marcar como pagada (si admin/gerente)

EmpleadoDetailPage:
- Pesta√±a con hist√≥rico de n√≥minas"
```

**Entregables:**
- ‚úÖ C√°lculo autom√°tico de n√≥minas
- ‚úÖ Generaci√≥n de PDFs profesionales
- ‚úÖ Gesti√≥n de pagos
- ‚úÖ Hist√≥rico por empleado

---

### Sprint 5: Inventario (Semanas 9-10)

#### Semana 9: Backend Inventario

```
"Sistema completo de inventario:

CATEGORIA_PRODUCTO:
- Entity simple con nombre
- Ejemplos: Whisky, Vodka, Ron, Ginebra, Refrescos, Consumibles

PRODUCTO:
- Entity completa
- Repository con:
  * findByCategoria
  * findByStockActualLessThan (para alertas)
  * buscar por nombre/marca
- Service con CRUD
- Migraci√≥n V010__create_productos_categorias.sql

STOCK_MOVIMIENTO:
- Entity con tipo (ENTRADA, SALIDA, AJUSTE, MERMA)
- StockService:
  * registrarMovimiento(productoId, tipo, cantidad, motivo)
    - Validar stock suficiente para SALIDA
    - Calcular nuevo stock
    - Guardar movimiento
    - Actualizar producto
  * obtenerStockActual(productoId)
  * obtenerAlertasStockBajo()
  * calcularValoracionInventario()
  * obtenerHistorialMovimientos(filters)
- Migraci√≥n V011__create_stock_movimientos.sql

Controller completo
Tests"
```

#### Semana 10: Frontend Inventario

```
"Frontend de Inventario:

ProductosPage:
- Tabla con stock actual
- Badge de alerta (stock < m√≠nimo) en rojo
- Filtros: categor√≠a, stock bajo
- ProductoForm
- productoService.ts

StockPage:
- Vista de stock actual por producto
- Filtros y b√∫squeda
- Acci√≥n r√°pida: registrar movimiento

MovimientosPage:
- Hist√≥rico de movimientos
- Filtros: producto, tipo, rango fechas
- Modal para registrar nuevo movimiento
- movimientoService.ts

InventarioDashboard:
- Card: Valoraci√≥n total
- Lista de alertas (stock bajo)
- Top productos por rotaci√≥n
- Gr√°fico: movimientos por tipo"
```

**Entregables:**
- ‚úÖ Cat√°logo de productos
- ‚úÖ Sistema de movimientos
- ‚úÖ Alertas de stock bajo
- ‚úÖ Valoraci√≥n de inventario

---

### Sprint 6: Compras y Proveedores (Semana 11)

```
"Sistema de compras:

PEDIDO y DETALLE_PEDIDO:
- Entities con relaci√≥n
- PedidoService:
  * crearPedido(proveedorId, List<DetallePedidoDTO>)
  * recepcionarPedido(pedidoId)
    - Cambiar estado a RECIBIDO
    - Crear movimientos de stock (ENTRADA) para cada producto
    - Registrar gasto autom√°tico
  * cancelarPedido
- Controller
- Migraci√≥n V012__create_pedidos.sql

Frontend:
- PedidosPage con estados
- PedidoForm: seleccionar proveedor y productos
- Modal de recepci√≥n con checklist
- pedidoService.ts"
```

**Entregables:**
- ‚úÖ Gesti√≥n de pedidos
- ‚úÖ Recepci√≥n automatizada
- ‚úÖ Integraci√≥n con stock y gastos

---

## FASE 3: Analytics y Finalizaci√≥n (Semanas 12-15)

### Sprint 7: Dashboard Ejecutivo (Semanas 12-13)

```
"Dashboard ejecutivo completo:

AnalyticsService:
- obtenerKPIs(periodo):
  * Total ingresos
  * Total gastos
  * Beneficio neto
  * Margen %
  * Aforo promedio
  * Revenue por persona
  * Comparativa per√≠odo anterior

- obtenerTendencias(meses):
  * Evoluci√≥n ingresos/gastos mensual
  * Eventos por mes
  * Rentabilidad por mes

- obtenerEventosMasRentables(top)
- obtenerProductosMasVendidos(top)
- obtenerDistribucionGastos(periodo)

Controller: AnalyticsController

Frontend:
- DashboardPage completamente redise√±ado:
  * Grid de KPI cards con comparativas
  * Gr√°fico l√≠nea: evoluci√≥n temporal
  * Gr√°fico pie: distribuci√≥n gastos
  * Gr√°fico bar: top eventos rentables
  * Tabla: pr√≥ximos eventos
  * Alertas: stock bajo, gastos pendientes, n√≥minas pendientes
- Filtros temporales
- Exportar dashboard a PDF
- analyticsService.ts"
```

---

### Sprint 8: Reportes Avanzados (Semana 14)

```
"Sistema de reportes avanzados:

ReportService:
- Plantillas JasperReports:
  * P&L mensual
  * Resumen de evento
  * N√≥minas del mes
  * Inventario valorado
  * Comparativa eventos
  
- Exportaci√≥n Excel (Apache POI):
  * Lista de gastos
  * Lista de ingresos
  * Movimientos de stock
  * Turnos de empleados

- generarReporte(plantilla, parametros) ‚Üí byte[]

Controller: ReportController

Frontend:
- ReportesPage:
  * Selector de plantilla
  * Form de par√°metros (din√°mico seg√∫n plantilla)
  * Preview PDF inline
  * Bot√≥n descarga
  * Hist√≥rico de reportes generados"
```

---

### Sprint 9: Optimizaci√≥n Final (Semana 15)

```
"Optimizaci√≥n y testing final:

Backend:
1. A√±adir √≠ndices faltantes
2. Optimizar queries lentas (EXPLAIN ANALYZE)
3. Tests E2E con REST Assured
4. Performance testing b√°sico
5. Completar Swagger docs
6. README t√©cnico actualizado

Frontend:
1. Code splitting y lazy loading
2. Optimizar bundle size
3. Lighthouse audit y mejoras
4. Tests E2E con Playwright
5. Responsive testing en todos los dispositivos
6. Accesibilidad (WCAG AA)

General:
1. Security audit
2. Load testing b√°sico
3. Backup/restore testing
4. User documentation
5. Video tutorials cortos"
```

**Entregables COMPLETOS:**
- ‚úÖ Sistema 100% funcional
- ‚úÖ Optimizado y testeado
- ‚úÖ Documentado completamente
- ‚úÖ **Production-ready en 12 semanas**

---

## üéØ Diferencias vs Versi√≥n con Integraciones

| Aspecto | Con Integraciones | Sin Integraciones |
|---------|-------------------|-------------------|
| **Duraci√≥n** | 16 semanas | **12 semanas** ‚úÖ |
| **Complejidad** | Alta | **Media** ‚úÖ |
| **Puntos de fallo** | 3 sistemas | **1 sistema** ‚úÖ |
| **Mantenimiento** | Complejo | **Simple** ‚úÖ |
| **Registro de ventas** | Autom√°tico | Manual (7 min/evento) |
| **Funcionalidad core** | 100% | **100%** ‚úÖ |
| **Coste desarrollo** | $0 | **$0** ‚úÖ |
| **Curva aprendizaje** | Empinada | **Suave** ‚úÖ |

---

## üìä Workflow Real Post-Evento

### Con Sistema Manual (7 minutos):

```
1. Abrir sistema (30 seg)
2. Ir a evento ‚Üí Finanzas (10 seg)
3. Clic "Registrar Ingreso" (5 seg)

4. Llenar formulario:
   - Fuente: Taquilla Anticipada
   - Monto: ‚Ç¨3,450 (del reporte Fourvenues)
   - M√©todo: Transferencia
   - Notas: "Ventas Fourvenues - 230 entradas"
   - Guardar (1 min)

5. Clic "Registrar Ingreso" de nuevo
   - Fuente: Barra
   - Monto: ‚Ç¨5,230 (del cierre de caja POS)
   - M√©todo: Mixto
   - Notas: "Cierre de caja - Reporte POS"
   - Guardar (30 seg)

6. Registrar gastos si hay (3-4 min)

7. Ver P&L calculado autom√°ticamente (10 seg)
   ‚úÖ Listo!

TOTAL: 7 minutos por evento
```

**¬øVale la pena ahorrar 7 minutos vs 4 semanas de desarrollo extra? S√ç** üéØ

---

## ‚úÖ Checklist de Hitos

### Semana 6 - MVP
- [ ] Login funcional
- [ ] CRUD eventos completo
- [ ] Registro manual de gastos/ingresos
- [ ] P&L autom√°tico por evento
- [ ] Asignaci√≥n b√°sica de personal
- [ ] **Sistema usable en producci√≥n** ‚úÖ

### Semana 11 - Sistema Avanzado
- [ ] N√≥minas autom√°ticas
- [ ] Inventario completo
- [ ] Sistema de compras
- [ ] Gesti√≥n completa de proveedores

### Semana 15 - Sistema Completo
- [ ] Dashboard ejecutivo
- [ ] Reportes avanzados
- [ ] Sistema optimizado
- [ ] Documentaci√≥n completa
- [ ] **Production-ready total** ‚úÖ

---

[‚Üê Anterior: M√≥dulos Funcionales](./05-modulos-funcionales.md) | [Siguiente: Setup y Despliegue ‚Üí](./07-setup-despliegue.md)